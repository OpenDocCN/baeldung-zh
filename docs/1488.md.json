["```\r\nKafkaConsumer<String, String> consumer = new KafkaConsumer<String, String>(props);\r\n```","```\r\nList<TopicPartition> partitions = consumer.partitionsFor(topic).stream().map(p -> new TopicPartition(topic, p.partition()))\r\n    .collect(Collectors.toList());\r\n```","```\r\nconsumer.assign(partitions);\r\nconsumer.seekToEnd(Collections.emptySet());\r\nMap<TopicPartition, Long> endPartitions = partitions.stream().collect(Collectors.toMap(Function.identity(), consumer::position));\r\n```","```\r\nnumberOfMessages = partitions.stream().mapToLong(p -> endPartitions.get(p)).sum();\r\n```","```\r\n$ bin/kafka-run-class.sh kafka.tools.GetOffsetShell   --broker-list localhost:9092   \r\n--topic baeldung   | awk -F  \":\" '{sum += $3} END {print \"Result: \"sum}'\r\nResult: 3\r\n```","```\r\n$ bin/kafka-console-consumer.sh  --from-beginning  --bootstrap-server localhost:9092 \r\n--property print.key=true --property print.value=false --property print.partition \r\n--topic baeldung --timeout-ms 5000 | tail -n 10|grep \"Processed a total of\"\r\nProcessed a total of 3 messages\r\n```"]