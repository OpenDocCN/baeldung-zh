["```\r\n@Component\r\npublic class CustomAuthenticationProvider implements AuthenticationProvider {\r\n\r\n    @Override\r\n    public Authentication authenticate(Authentication authentication) \r\n      throws AuthenticationException {\r\n\r\n        String name = authentication.getName();\r\n        String password = authentication.getCredentials().toString();\r\n\r\n        if (shouldAuthenticateAgainstThirdPartySystem()) {\r\n\r\n            // use the credentials\r\n            // and authenticate against the third-party system\r\n            return new UsernamePasswordAuthenticationToken(\r\n              name, password, new ArrayList<>());\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public boolean supports(Class<?> authentication) {\r\n        return authentication.equals(UsernamePasswordAuthenticationToken.class);\r\n    }\r\n}\r\n```","```\r\n<http use-expressions=\"true\">\r\n    <intercept-url pattern=\"/**\" access=\"isAuthenticated()\"/>\r\n    <http-basic/>\r\n</http>\r\n\r\n<authentication-manager>\r\n    <authentication-provider\r\n      ref=\"customAuthenticationProvider\" />\r\n</authentication-manager>\r\n```","```\r\n@Configuration\r\n@EnableWebSecurity\r\n@ComponentScan(\"com.baeldung.security\")\r\npublic class SecurityConfig extends WebSecurityConfigurerAdapter {\r\n\r\n    @Autowired\r\n    private CustomAuthenticationProvider authProvider;\r\n\r\n    @Override\r\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\r\n        auth.authenticationProvider(authProvider);\r\n    }\r\n\r\n    @Override\r\n    protected void configure(HttpSecurity http) throws Exception {\r\n        http.authorizeRequests().anyRequest().authenticated()\r\n            .and().httpBasic();\r\n    }\r\n}\r\n```","```\r\ncurl --header \"Accept:application/json\" -i --user user1:user1Pass \r\n    http://localhost:8080/spring-security-custom/api/foo/1\r\n```","```\r\nHTTP/1.1 200 OK\r\nServer: Apache-Coyote/1.1\r\nSet-Cookie: JSESSIONID=B8F0EFA81B78DE968088EBB9AFD85A60; Path=/spring-security-custom/; HttpOnly\r\nContent-Type: application/json;charset=UTF-8\r\nTransfer-Encoding: chunked\r\nDate: Sun, 02 Jun 2013 17:50:40 GMT\r\n```"]