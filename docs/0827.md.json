["```\r\npublic class User {\r\n    static HashMap<String, User> DB = new HashMap<>();\r\n    static {\r\n        DB.put(\"user\", new User(\"user\", \"pass\"));\r\n        // ...\r\n    }\r\n\r\n    private String name;\r\n    private String password;\r\n\r\n    // getters and setters\r\n}\r\n```","```\r\n@WebFilter(\"/*\")\r\npublic class UserCheckFilter implements Filter {\r\n\r\n    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) {\r\n        // ...\r\n        request.setAttribute(\"origin\", request.getRequestURI());\r\n\r\n        if (!request.getRequestURI().contains(\"login\") && request.getSession(false) == null) {\r\n            forward(request, response, \"/login.jsp\");\r\n            return;\r\n        }\r\n\r\n        chain.doFilter(request, response);\r\n    }\r\n}\r\n```","```\r\n<%@ page session=\"false\"%>\r\n<%@ taglib uri=\"http://java.sun.com/jstl/core_rt\" prefix=\"c\"%>\r\n\r\n<form action=\"login\" method=\"POST\">\r\n    ...\r\n</form> \r\n```","```\r\n<input type=\"hidden\" name=\"origin\" value=\"${origin}\">\r\n```","```\r\n<c:if test=\"${not empty error}\">\r\n    * error: ${error} \r\n</c:if>\r\n```","```\r\n<input type=\"text\" name=\"name\">\r\n<input type=\"password\" name=\"password\"> \r\n<input type=\"submit\">\r\n```","```\r\n@WebServlet(\"/login\")\r\npublic class UserCheckLoginServlet extends HttpServlet {\r\n    // ...\r\n} \r\n```","```\r\nprotected void doGet(HttpServletRequest request, HttpServletResponse response) {\r\n    String referer = (String) request.getAttribute(\"origin\");\r\n    request.setAttribute(\"origin\", referer);\r\n    forward(request, response, \"/login.jsp\");\r\n}\r\n```","```\r\nprotected void doPost(HttpServletRequest request, HttpServletResponse response) {\r\n    String key = request.getParameter(\"name\");\r\n    String pass = request.getParameter(\"password\");\r\n\r\n    User user = User.DB.get(key);\r\n    if (!user.getPassword().equals(pass)) {\r\n        request.setAttribute(\"error\", \"invalid login\");\r\n        forward(request, response, \"/login.jsp\");\r\n        return;\r\n    }\r\n\r\n    HttpSession session = request.getSession();\r\n    session.setAttribute(\"user\", user);\r\n\r\n    response.sendRedirect(request.getParameter(\"origin\"));\r\n}\r\n```","```\r\n<body>\r\n    current session info: ${user.name}\r\n\r\n    <a href=\"logout\">logout</a>\r\n</body> \r\n```","```\r\n@WebServlet(\"/home\")\r\npublic class UserCheckServlet extends HttpServlet {\r\n\r\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) {\r\n        User user = (User) session.getAttribute(\"user\");\r\n        request.setAttribute(\"user\", user);\r\n\r\n        forward(request, response, \"/home.jsp\");\r\n    }\r\n}\r\n```","```\r\n@WebServlet(\"/logout\")\r\npublic class UserCheckLogoutServlet extends HttpServlet {\r\n\r\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) {\r\n        request.getSession().invalidate();\r\n\r\n        response.sendRedirect(\"./\");\r\n    }\r\n}\r\n```"]