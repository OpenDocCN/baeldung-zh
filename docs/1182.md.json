["```\r\n<dependency>\r\n    <groupId>org.springframework.boot</groupId>\r\n    <artifactId>spring-boot-starter-actuator</artifactId>\r\n    <version>2.2.2.RELEASE</version>\r\n</dependency> \r\n```","```\r\n@Component\r\npublic class LoginAttemptsLogger {\r\n\r\n    @EventListener\r\n    public void auditEventHappened(\r\n      AuditApplicationEvent auditApplicationEvent) {\r\n\r\n        AuditEvent auditEvent = auditApplicationEvent.getAuditEvent();\r\n        System.out.println(\"Principal \" + auditEvent.getPrincipal() \r\n          + \" - \" + auditEvent.getType());\r\n\r\n        WebAuthenticationDetails details = \r\n          (WebAuthenticationDetails) auditEvent.getData().get(\"details\");\r\n        System.out.println(\"Remote IP address: \" \r\n          + details.getRemoteAddress());\r\n        System.out.println(\"  Session Id: \" + details.getSessionId());\r\n    }\r\n} \r\n```","```\r\nPrincipal anonymousUser - AUTHORIZATION_FAILURE\r\n  Remote IP address: 0:0:0:0:0:0:0:1\r\n  Session Id: null\r\nPrincipal user - AUTHENTICATION_FAILURE\r\n  Remote IP address: 0:0:0:0:0:0:0:1\r\n  Session Id: BD41692232875A5A65C5E35E63D784F6\r\nPrincipal user - AUTHENTICATION_SUCCESS\r\n  Remote IP address: 0:0:0:0:0:0:0:1\r\n  Session Id: BD41692232875A5A65C5E35E63D784F6 \r\n```","```\r\n@Component\r\npublic class ExposeAttemptedPathAuthorizationAuditListener \r\n  extends AbstractAuthorizationAuditListener {\r\n\r\n    public static final String AUTHORIZATION_FAILURE \r\n      = \"AUTHORIZATION_FAILURE\";\r\n\r\n    @Override\r\n    public void onApplicationEvent(AbstractAuthorizationEvent event) {\r\n        if (event instanceof AuthorizationFailureEvent) {\r\n            onAuthorizationFailureEvent((AuthorizationFailureEvent) event);\r\n        }\r\n    }\r\n\r\n    private void onAuthorizationFailureEvent(\r\n      AuthorizationFailureEvent event) {\r\n        Map<String, Object> data = new HashMap<>();\r\n        data.put(\r\n          \"type\", event.getAccessDeniedException().getClass().getName());\r\n        data.put(\"message\", event.getAccessDeniedException().getMessage());\r\n        data.put(\r\n          \"requestUrl\", ((FilterInvocation)event.getSource()).getRequestUrl() );\r\n\r\n        if (event.getAuthentication().getDetails() != null) {\r\n            data.put(\"details\", \r\n              event.getAuthentication().getDetails());\r\n        }\r\n        publish(new AuditEvent(event.getAuthentication().getName(), \r\n          AUTHORIZATION_FAILURE, data));\r\n    }\r\n} \r\n```","```\r\n@Component\r\npublic class LoginAttemptsLogger {\r\n\r\n    @EventListener\r\n    public void auditEventHappened(\r\n      AuditApplicationEvent auditApplicationEvent) {\r\n        AuditEvent auditEvent = auditApplicationEvent.getAuditEvent();\r\n\r\n        System.out.println(\"Principal \" + auditEvent.getPrincipal() \r\n          + \" - \" + auditEvent.getType());\r\n\r\n        WebAuthenticationDetails details\r\n          = (WebAuthenticationDetails) auditEvent.getData().get(\"details\");\r\n\r\n        System.out.println(\"  Remote IP address: \" \r\n          + details.getRemoteAddress());\r\n        System.out.println(\"  Session Id: \" + details.getSessionId());\r\n        System.out.println(\"  Request URL: \" \r\n          + auditEvent.getData().get(\"requestUrl\"));\r\n    }\r\n} \r\n```","```\r\nPrincipal anonymousUser - AUTHORIZATION_FAILURE\r\n  Remote IP address: 0:0:0:0:0:0:0:1\r\n  Session Id: null\r\n  Request URL: /hello \r\n```","```\r\nmvn clean spring-boot:run \r\n```","```\r\n{\r\n  \"events\": [\r\n    {\r\n      \"timestamp\": \"2017-03-09T19:21:59+0000\",\r\n      \"principal\": \"anonymousUser\",\r\n      \"type\": \"AUTHORIZATION_FAILURE\",\r\n      \"data\": {\r\n        \"requestUrl\": \"/auditevents\",\r\n        \"details\": {\r\n          \"remoteAddress\": \"0:0:0:0:0:0:0:1\",\r\n          \"sessionId\": null\r\n        },\r\n        \"type\": \"org.springframework.security.access.AccessDeniedException\",\r\n        \"message\": \"Access is denied\"\r\n      }\r\n    },\r\n    {\r\n      \"timestamp\": \"2017-03-09T19:22:00+0000\",\r\n      \"principal\": \"anonymousUser\",\r\n      \"type\": \"AUTHORIZATION_FAILURE\",\r\n      \"data\": {\r\n        \"requestUrl\": \"/favicon.ico\",\r\n        \"details\": {\r\n          \"remoteAddress\": \"0:0:0:0:0:0:0:1\",\r\n          \"sessionId\": \"18FA15865F80760521BBB736D3036901\"\r\n        },\r\n        \"type\": \"org.springframework.security.access.AccessDeniedException\",\r\n        \"message\": \"Access is denied\"\r\n      }\r\n    },\r\n    {\r\n      \"timestamp\": \"2017-03-09T19:22:03+0000\",\r\n      \"principal\": \"user\",\r\n      \"type\": \"AUTHENTICATION_SUCCESS\",\r\n      \"data\": {\r\n        \"details\": {\r\n          \"remoteAddress\": \"0:0:0:0:0:0:0:1\",\r\n          \"sessionId\": \"18FA15865F80760521BBB736D3036901\"\r\n        }\r\n      }\r\n    }\r\n  ]\r\n} \r\n```"]