["```\r\n<dependency>\r\n    <groupId>org.apache.kafka</groupId>\r\n    <artifactId>kafka-clients</artifactId>\r\n    <version>2.8.0</version>\r\n</dependency> \r\n```","```\r\n@Data\r\n@AllArgsConstructor\r\n@NoArgsConstructor\r\n@Builder\r\npublic class MessageDto {\r\n    private String message;\r\n    private String version;\r\n}\r\n```","```\r\npublic class CustomSerializer implements Serializer<MessageDto> {\r\n    private final ObjectMapper objectMapper = new ObjectMapper();\r\n\r\n    @Override\r\n    public void configure(Map<String, ?> configs, boolean isKey) {\r\n    }\r\n\r\n    @Override\r\n    public byte[] serialize(String topic, MessageDto data) {\r\n        try {\r\n            if (data == null){\r\n                System.out.println(\"Null received at serializing\");\r\n                return null;\r\n            }\r\n            System.out.println(\"Serializing...\");\r\n            return objectMapper.writeValueAsBytes(data);\r\n        } catch (Exception e) {\r\n            throw new SerializationException(\"Error when serializing MessageDto to byte[]\");\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void close() {\r\n    }\r\n} \r\n```","```\r\n@Slf4j\r\npublic class CustomDeserializer implements Deserializer<MessageDto> {\r\n    private ObjectMapper objectMapper = new ObjectMapper();\r\n\r\n    @Override\r\n    public void configure(Map<String, ?> configs, boolean isKey) {\r\n    }\r\n\r\n    @Override\r\n    public MessageDto deserialize(String topic, byte[] data) {\r\n        try {\r\n            if (data == null){\r\n                System.out.println(\"Null received at deserializing\");\r\n                return null;\r\n            }\r\n            System.out.println(\"Deserializing...\");\r\n            return objectMapper.readValue(new String(data, \"UTF-8\"), MessageDto.class);\r\n        } catch (Exception e) {\r\n            throw new SerializationException(\"Error when deserializing byte[] to MessageDto\");\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void close() {\r\n    }\r\n} \r\n```","```\r\nprivate static KafkaProducer<String, MessageDto> createKafkaProducer() {\r\n    Properties props = new Properties();\r\n    props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, kafka.getBootstrapServers());\r\n    props.put(ProducerConfig.CLIENT_ID_CONFIG, CONSUMER_APP_ID);\r\n    props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, \"org.apache.kafka.common.serialization.StringSerializer\");\r\n    props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, \"com.baeldung.kafka.serdes.CustomSerializer\");\r\n\r\n    return new KafkaProducer(props);\r\n}\r\n```","```\r\nprivate static KafkaConsumer<String, MessageDto> createKafkaConsumer() {\r\n    Properties props = new Properties();\r\n    props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, kafka.getBootstrapServers());\r\n    props.put(ConsumerConfig.CLIENT_ID_CONFIG, CONSUMER_APP_ID);\r\n    props.put(ConsumerConfig.GROUP_ID_CONFIG, CONSUMER_GROUP_ID);\r\n    props.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, \"earliest\");\r\n    props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, \"org.apache.kafka.common.serialization.StringDeserializer\");\r\n    props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, \"com.baeldung.kafka.serdes.CustomDeserializer\");\r\n\r\n    return new KafkaConsumer<>(props);\r\n}\r\n```","```\r\nMessageDto msgProd = MessageDto.builder().message(\"test\").version(\"1.0\").build();\r\n\r\nKafkaProducer<String, MessageDto> producer = createKafkaProducer();\r\nproducer.send(new ProducerRecord<String, MessageDto>(TOPIC, \"1\", msgProd));\r\nSystem.out.println(\"Message sent \" + msgProd);\r\nproducer.close();\r\n```","```\r\nAtomicReference<MessageDto> msgCons = new AtomicReference<>();\r\n\r\nKafkaConsumer<String, MessageDto> consumer = createKafkaConsumer();\r\nconsumer.subscribe(Arrays.asList(TOPIC));\r\n\r\nConsumerRecords<String, MessageDto> records = consumer.poll(Duration.ofSeconds(1));\r\nrecords.forEach(record -> {\r\n    msgCons.set(record.value());\r\n    System.out.println(\"Message received \" + record.value());\r\n});\r\n\r\nconsumer.close();\r\n```","```\r\nSerializing...\r\nMessage sent MessageDto(message=test, version=1.0)\r\nDeserializing...\r\nMessage received MessageDto(message=test, version=1.0)\r\n```"]