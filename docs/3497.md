# 探索 Docker 容器的文件系统

> 原文：<https://web.archive.org/web/20220930061024/https://www.baeldung.com/ops/docker-container-filesystem>

## 1.概观

当我们使用 Docker 时，有时我们需要检查容器中的配置或日志文件。

在这个快速教程中，我们将看到如何检查一个 [Docker 容器](/web/20220901074910/https://www.baeldung.com/docker-images-vs-containers)的文件系统，以帮助我们解决这种情况。

## 2.互动探索

如果我们获得了对大多数容器的 shell 访问，我们就可以交互地探索它们的文件系统。

### 2.1.使用 Shell 访问运行容器

让**使用带有`-it` 选项**的`docker run`命令通过 shell 访问直接启动一个容器:

[PRE0]

在这里，我们以交互模式启动了 Alpine Linux 容器，并连接到它的 shell。

但是如果我们想探索一些不是 Linux 发行版的东西，会发生什么呢？

[PRE1]

Cassandra docker 容器带有一个默认的启动命令，它运行 Cassandra。因此，我们不再连接到外壳。

相反，我们只看到应用程序的日志消息填充的标准输出。

但是，**我们可以绕过默认的启动命令。**

**让我们将`/bin/bash` 附加参数传递给`docker run`命令** :

[PRE2]

不幸的是，这有一个严重的副作用。实际的 Cassandra 应用程序不再启动，我们必须从 shell 中手动完成这项工作。

当我们使用这种方法时，我们假设我们可以控制容器的启动。在生产环境中，这可能是不可能的。

### 2.2.在运行的容器中生成 Shell

幸运的是，我们可以使用**和`docker exec` 命令，其中**和**允许我们连接到正在运行的容器**。

让我们首先开始我们想要探索的容器:

[PRE3]

接下来，我们用 `**docker ps**`来标识容器 id:

[PRE4]

然后，我们**将`/bin/bash`作为带有`-it` 选项的自变量传递给 `docker exec`** :

[PRE5]

在这里，**我们使用 Bash 作为我们选择的 shell**。**这取决于容器基于哪个 Linux 发行版。**

相比之下，我们的第一个例子使用 Alpine Linux，默认情况下它带有 Bourne Shell:

[PRE6]

由于 Bash 不可用，我们将`/bin/sh`作为参数传递给`docker exec`:

[PRE7]

## 3.非互动探索

有时，**容器被停止，我们不能交互地运行它，**或者它根本没有外壳。

例如， [hello-world](https://web.archive.org/web/20220901074910/https://hub.docker.com/_/hello-world) 是 **从 [scratch](https://web.archive.org/web/20220901074910/https://hub.docker.com/_/scratch)** 开始的**最小容器。因此，shell 访问是不可能的。**

幸运的是，在这两种情况下，我们都可以将文件系统转储到我们的主机上，以便进一步研究。

让我们看看我们如何能做到这一点。

### 3.1.导出文件系统

我们可以通过使用 `**docker export**` 命令将容器的文件系统导出到 [tar](/web/20220901074910/https://www.baeldung.com/linux/zip-unzip-command-line) 文件中。

让我们首先运行 hello-world 容器:

[PRE8]

类似地，我们首先通过将`-a`标志传递给`docker ps` **:** 来让**获得一个停止的集装箱的集装箱 id**

[PRE9]

然后我们使用`docker export` 的`-o`选项将文件系统转储到 hello.tar 文件中**:**

[PRE10]

最后，**我们使用带有`-tvf` 标志**的`tar` 实用程序打印归档文件的内容:

[PRE11]

或者，我们可以使用任何归档浏览器来查看里面的内容。

### 3.2.复制文件系统

**我们也可以使用`docker cp` 命令**复制整个文件系统。

让我们也试试这个。

**首先，我们将从`the root (/)`** 开始的完整文件系统从我们的容器复制到`test`目录:

[PRE12]

接下来，让我们打印`test`目录的内容:

[PRE13]

## 4.结论

在这个快速教程中，我们讨论了如何探索 Docker 容器的文件系统。

我们可以直接用`docker` `run` 命令启动大多数带有 shell 访问的容器。此外，我们可以在`docker exec.`的帮助下生成一个运行容器的外壳

对于停止的容器或最小容器，我们可以简单地导出甚至本地复制整个文件系统。