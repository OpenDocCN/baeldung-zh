# 在 Reddit 应用程序中将注册与登录分离

> 原文：<https://web.archive.org/web/20220930061024/https://www.baeldung.com/reddit-app-replace-reddit-auth-with-form-based-login>

## **1。概述**

在本教程中—**我们将用一个更简单的基于表单的登录**来取代 Reddit 支持的 OAuth2 认证过程。

在我们登录之后，我们仍然能够将 Reddit 连接到应用程序,我们只是不使用 Reddit 来驱动我们的主登录流程。

## **2。基本用户注册**

首先，让我们替换旧的认证流程。

### **2.1。`User`实体**

我们将对用户实体进行一些更改:使`username`唯一，添加一个`password`字段(临时) :

[PRE0]

### **2.2。注册新用户**

接下来，让我们看看如何在后端注册新用户:

[PRE1]

显然，这对于用户来说是一个基本的创建操作——没有多余的东西。

下面是服务层中的**实际实现:**

[PRE2]

### **2.3。异常处理**

还有简单的`UserAlreadyExistsException`:

[PRE3]

该异常在应用程序的主异常处理程序**中处理:**

[PRE4]

### **2.4。一个简单的注册页面**

最后，一个简单的前端`signup.html`:

[PRE5]

值得一提的是，这并不是一个完全成熟的注册流程，只是一个非常快速的流程。要了解完整的注册流程，您可以在 Baeldung 查看主注册系列。

## **3。新登录页面**

这是我们的**新的简单登录页面**:

[PRE6]

## **4。安全配置**

现在，让我们来看看**新的安全配置**:

[PRE7]

大多数事情都很简单，所以我们不会在这里详细讨论。

这里有一个习俗:

[PRE8]

这是我们的习俗`Principal``UserPrincipal”`，它实现了`UserDetails`:

[PRE9]

注意:我们使用我们的自定义`Principal` " `UserPrincipal”`而不是 Spring 安全默认`User`。

## **5。认证 Reddit**

既然我们的认证流程不再依赖 Reddit，我们需要**让用户在登录后将他们的账户连接到 Reddit** 。

首先，我们需要修改旧的 Reddit 登录逻辑:

[PRE10]

以及实际的实现——`connectReddit()`方法:

[PRE11]

注意现在如何使用`redditLogin()`逻辑通过获取用户的`AccessToken`将我们系统中的用户帐户与他的 Reddit 帐户连接起来。

至于前端——这很简单:

[PRE12]

我们还需要确保用户在尝试提交帖子之前确实将他们的帐户连接到 Reddit:

[PRE13]

## **6。结论**

小小的 reddit 应用肯定是在前进的。

旧的认证流程——完全由 Reddit 支持——引发了一些问题。所以现在，**我们有了一个干净简单的基于表单的登录**，同时仍然能够在后端连接你的 Reddit API。

好东西。