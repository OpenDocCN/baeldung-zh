# 用 Spring MVC 上传和显示 Excel 文件

> 原文：<https://web.archive.org/web/20220930061024/https://www.baeldung.com/spring-mvc-excel-files>

## **1。简介**

在本文中，我们将演示如何使用`Spring MVC`框架**上传 Excel 文件并在网页**中显示其内容。

## **2。上传 Excel 文件**

为了能够上传文件，我们将首先创建一个控制器映射，它接收一个`MultipartFile`并将其保存在当前位置:

[PRE0]

接下来，让我们用一个包含`type file`的`input`的表单创建一个`JSP`文件，该表单将`accept`属性设置为只允许 Excel 文件:

[PRE1]

## **3。读取 Excel 文件**

为了解析上传的 excel 文件，我们将使用`Apache POI`库，它可以处理`.xls`和`.xlsx`文件。

让我们创建一个名为`MyCell`的助手类，它将包含与内容和格式相关的 Excel 单元格的属性:

[PRE2]

我们将把 Excel 文件的内容读入一个包含`MyCell`对象列表的`Map`中。

### **3.1。解析. xls 文件**

**一个`.xls`文件在`Apache POI`库中由一个`HSSFWorkbook`** **类**表示，该类由`HSSFSheet`对象组成。为了打开和阅读一个`.xls`文件的内容，你可以查看我们关于[在 Java 中使用 Microsoft Excel](/web/20220815042739/https://www.baeldung.com/java-microsoft-excel)的文章。

**为了解析单元格的格式，我们将获得`HSSFCellStyle`** **对象，**，它可以帮助我们确定背景颜色和字体等属性。所有读取的属性将在`MyCell`对象的属性中设置:

[PRE3]

**颜色以`rgb(rVal, gVal, bVal)`格式读取，以便在`JSP`页面中使用`CSS`更容易显示。**

让我们也获得字体大小、粗细和颜色:

[PRE4]

### **3.2。解析. xlsx 文件**

**对于较新的`.xlsx`格式的文件，我们可以使用`XSSFWorkbook`类**和类似的用于工作簿内容的类，也可以在[在 Java 中使用 Microsoft Excel](/web/20220815042739/https://www.baeldung.com/java-microsoft-excel)一文中找到。

让我们仔细看看如何以`.xlsx`格式读取单元格的格式。首先，**我们将检索与单元格相关联的`XSSFCellStyle`对象**，并使用它来确定背景颜色和字体:

[PRE5]

在这种情况下，颜色的`RGB`值将是`signed byte`值，因此我们将通过将`0xff`与负值相加来获得`unsigned`值。

让我们也确定字体的属性:

[PRE6]

### **3.3。处理空行**

**上述方法不考虑 Excel 文件中的空行。**如果我们想要忠实地再现显示空行的文件，我们将需要在我们的结果`HashMap`中模拟这些，用包含空`Strings`的`MyCell`对象的`ArrayList`作为内容。

最初，读取 Excel 文件后，文件中的空行将是大小为 0 的`ArrayList`对象。

为了确定我们应该添加多少空的`String`对象，我们将首先使用`maxNrCols`变量确定 Excel 文件中最长的一行。然后，我们将把这个数量的空的`String`对象添加到我们的`HashMap`中所有大小为 0:

[PRE7]

## **4。显示 Excel 文件**

为了显示使用`Spring MVC`读取的 Excel 文件，我们需要定义一个控制器映射和`JSP`页面。

### **4.1。弹簧 MVC 控制器**

让我们创建一个`@RequestMapping`方法，该方法将调用上面的代码来读取上传文件的内容，然后添加返回的`Map`作为一个`Model`属性:

[PRE8]

### **4.2。JSP**

为了直观地显示文件的内容，我们将创建一个`HTML` `table`，并在每个表格单元格的`style`属性中添加 Excel 文件中每个单元格对应的格式属性:

[PRE9]

## **5。结论**

在本文中，我们展示了一个使用`Spring MVC`框架上传 Excel 文件并在网页中显示它们的示例项目。

完整的源代码可以在 [GitHub 项目](https://web.archive.org/web/20220815042739/https://github.com/eugenp/tutorials/tree/master/spring-web-modules/spring-mvc-java)中找到。