["```\r\n@Test\r\npublic void whenEncryptingIntoFile_andDecryptingFileAgain_thenOriginalStringIsReturned() {\r\n    String originalContent = \"foobar\";\r\n    SecretKey secretKey = KeyGenerator.getInstance(\"AES\").generateKey();\r\n\r\n    FileEncrypterDecrypter fileEncrypterDecrypter\r\n      = new FileEncrypterDecrypter(secretKey, \"AES/CBC/PKCS5Padding\");\r\n    fileEncrypterDecrypter.encrypt(originalContent, \"baz.enc\");\r\n\r\n    String decryptedContent = fileEncrypterDecrypter.decrypt(\"baz.enc\");\r\n    assertThat(decryptedContent, is(originalContent));\r\n\r\n    new File(\"baz.enc\").delete(); // cleanup\r\n}\r\n```","```\r\nFileEncrypterDecrypter(SecretKey secretKey, String transformation) {\r\n    this.secretKey = secretKey;\r\n    this.cipher = Cipher.getInstance(transformation);\r\n}\r\n```","```\r\nvoid encrypt(String content, String fileName) {\r\n    cipher.init(Cipher.ENCRYPT_MODE, secretKey);\r\n    byte[] iv = cipher.getIV();\r\n\r\n    try (FileOutputStream fileOut = new FileOutputStream(fileName);\r\n      CipherOutputStream cipherOut = new CipherOutputStream(fileOut, cipher)) {\r\n        fileOut.write(iv);\r\n        cipherOut.write(content.getBytes());\r\n    }\r\n}\r\n```","```\r\nString decrypt(String fileName) {\r\n    String content;\r\n\r\n    try (FileInputStream fileIn = new FileInputStream(fileName)) {\r\n        byte[] fileIv = new byte[16];\r\n        fileIn.read(fileIv);\r\n        cipher.init(Cipher.DECRYPT_MODE, secretKey, new IvParameterSpec(fileIv));\r\n\r\n        try (\r\n                CipherInputStream cipherIn = new CipherInputStream(fileIn, cipher);\r\n                InputStreamReader inputReader = new InputStreamReader(cipherIn);\r\n                BufferedReader reader = new BufferedReader(inputReader)\r\n            ) {\r\n\r\n            StringBuilder sb = new StringBuilder();\r\n            String line;\r\n            while ((line = reader.readLine()) != null) {\r\n                sb.append(line);\r\n            }\r\n            content = sb.toString();\r\n        }\r\n\r\n    }\r\n    return content;\r\n}\r\n```"]