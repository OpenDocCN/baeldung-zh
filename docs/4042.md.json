["```\r\nSecurityContext context = SecurityContextHolder.getContext();\r\nAuthentication authentication = context.getAuthentication();\r\n```","```\r\n<dependency>\r\n    <groupId>org.springframework.boot</groupId>\r\n    <artifactId>spring-boot-starter-security</artifactId>\r\n</dependency>\r\n```","```\r\n<dependency>\r\n    <groupId>org.springframework.security</groupId>\r\n    <artifactId>spring-security-core</artifactId>\r\n    <version>5.2.1.RELEASE</version>\r\n</dependency>\r\n```","```\r\n@GetMapping(\"/authentication\")\r\npublic Object getAuthentication(@CurrentSecurityContext(expression = \"authentication\") \r\n  Authentication authentication) {\r\n    return authentication.getDetails();\r\n} \r\n```","```\r\n@Test\r\npublic void givenOAuth2Context_whenAccessingAuthentication_ThenRespondTokenDetails() {\r\n    ClientCredentialsResourceDetails resourceDetails = \r\n      getClientCredentialsResourceDetails(\"baeldung\", singletonList(\"read\"));\r\n    OAuth2RestTemplate restTemplate = getOAuth2RestTemplate(resourceDetails);\r\n\r\n    String authentication = executeGetRequest(restTemplate, \"/authentication\");\r\n\r\n    Pattern pattern = Pattern.compile(\"\\\\{\\\"remoteAddress\\\":\\\".*\"\r\n      + \"\\\",\\\"sessionId\\\":null,\\\"tokenValue\\\":\\\".*\"\r\n      + \"\\\",\\\"tokenType\\\":\\\"Bearer\\\",\\\"decodedDetails\\\":null}\");\r\n    assertTrue(\"authentication\", pattern.matcher(authentication).matches());\r\n}\r\n```","```\r\n@GetMapping(\"/principal\")\r\npublic String getPrincipal(@CurrentSecurityContext(expression = \"authentication.principal\") \r\n  Principal principal) { \r\n    return principal.getName(); \r\n}\r\n```","```\r\n@Test\r\npublic void givenOAuth2Context_whenAccessingPrincipal_ThenRespondBaeldung() {\r\n    ClientCredentialsResourceDetails resourceDetails = \r\n       getClientCredentialsResourceDetails(\"baeldung\", singletonList(\"read\"));\r\n    OAuth2RestTemplate restTemplate = getOAuth2RestTemplate(resourceDetails);\r\n\r\n    String principal = executeGetRequest(restTemplate, \"/principal\");\r\n\r\n    assertEquals(\"baeldung\", principal);\r\n}\r\n```"]