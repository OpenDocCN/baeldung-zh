["```\r\n@Configuration\r\n@EnableGlobalMethodSecurity(securedEnabled = true)\r\npublic class MethodSecurityConfig extends GlobalMethodSecurityConfiguration {\r\n    @Override\r\n    protected RunAsManager runAsManager() {\r\n        RunAsManagerImpl runAsManager = new RunAsManagerImpl();\r\n        runAsManager.setKey(\"MyRunAsKey\");\r\n        return runAsManager;\r\n    }\r\n}\r\n```","```\r\n@Autowired\r\npublic void configureGlobal(AuthenticationManagerBuilder auth) throws Exception {\r\n    ...\r\n    auth.authenticationProvider(runAsAuthenticationProvider());\r\n}\r\n\r\n@Bean\r\npublic AuthenticationProvider runAsAuthenticationProvider() {\r\n    RunAsImplAuthenticationProvider authProvider = new RunAsImplAuthenticationProvider();\r\n    authProvider.setKey(\"MyRunAsKey\");\r\n    return authProvider;\r\n}\r\n```","```\r\n@Controller\r\n@RequestMapping(\"/runas\")\r\nclass RunAsController {\r\n\r\n    @Secured({ \"ROLE_USER\", \"RUN_AS_REPORTER\" })\r\n    @RequestMapping\r\n    @ResponseBody\r\n    public String tryRunAs() {\r\n        Authentication auth = SecurityContextHolder.getContext().getAuthentication();\r\n        return \"Current User Authorities inside this RunAS method only \" + \r\n          auth.getAuthorities().toString();\r\n    }\r\n\r\n}\r\n```","```\r\n@Service\r\npublic class RunAsService {\r\n\r\n    @Secured({ \"ROLE_RUN_AS_REPORTER\" })\r\n    public Authentication getCurrentUser() {\r\n        Authentication authentication = \r\n          SecurityContextHolder.getContext().getAuthentication();\r\n        return authentication;\r\n    }\r\n}\r\n```","```\r\n<html>\r\n<body>\r\nCurrent user authorities: \r\n    <span sec:authentication=\"principal.authorities\">user</span>\r\n<br/>\r\n<span id=\"temp\"></span>\r\n<a href=\"#\" onclick=\"tryRunAs()\">Generate Report As Super User</a>\r\n\r\n<script src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js\"></script>\r\n<script type=\"text/javascript\">\r\nfunction tryRunAs(){\r\n    $.get( \"/runas\" , function( data ) {\r\n         $(\"#temp\").html(data);\r\n    });\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n```"]