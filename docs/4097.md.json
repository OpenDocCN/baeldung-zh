["```\r\n@Entity\r\npublic class Site {\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.AUTO)\r\n    private Long id;\r\n\r\n    @Column(nullable = false)\r\n    private String name;\r\n\r\n    @Column(nullable = false)\r\n    private String url;\r\n\r\n    @ManyToOne\r\n    @JoinColumn(name = \"user_id\", nullable = false)\r\n    private User user;\r\n}\r\n```","```\r\npublic interface SiteRepository extends JpaRepository<Site, Long> {\r\n    List<Site> findByUser(User user);\r\n}\r\n```","```\r\npublic interface ISiteService {\r\n\r\n    List<Site> getSitesByUser(User user);\r\n\r\n    void saveSite(Site site);\r\n\r\n    Site findSiteById(Long siteId);\r\n\r\n    void deleteSiteById(Long siteId);\r\n}\r\n```","```\r\n@Service\r\npublic class SiteService implements ISiteService {\r\n\r\n    @Autowired\r\n    private SiteRepository repo;\r\n\r\n    @Override\r\n    public List<Site> getSitesByUser(User user) {\r\n        return repo.findByUser(user);\r\n    }\r\n\r\n    @Override\r\n    public void saveSite(Site site) {\r\n        repo.save(site);\r\n    }\r\n\r\n    @Override\r\n    public Site findSiteById(Long siteId) {\r\n        return repo.findOne(siteId);\r\n    }\r\n\r\n    @Override\r\n    public void deleteSiteById(Long siteId) {\r\n        repo.delete(siteId);\r\n    }\r\n}\r\n```","```\r\n<dependency>\r\n    <groupId>com.rometools</groupId>\r\n    <artifactId>rome</artifactId>\r\n    <version>1.5.0</version>\r\n</dependency>\r\n```","```\r\npublic List<SiteArticle> getArticlesFromSite(Long siteId) {\r\n    Site site = repo.findOne(siteId);\r\n    return getArticlesFromSite(site);\r\n}\r\n\r\nList<SiteArticle> getArticlesFromSite(Site site) {\r\n    List<SyndEntry> entries;\r\n    try {\r\n        entries = getFeedEntries(site.getUrl());\r\n    } catch (Exception e) {\r\n        throw new FeedServerException(\"Error Occurred while parsing feed\", e);\r\n    }\r\n    return parseFeed(entries);\r\n}\r\n\r\nprivate List<SyndEntry> getFeedEntries(String feedUrl) \r\n  throws IllegalArgumentException, FeedException, IOException {\r\n    URL url = new URL(feedUrl);\r\n    SyndFeed feed = new SyndFeedInput().build(new XmlReader(url));\r\n    return feed.getEntries();\r\n}\r\n\r\nprivate List<SiteArticle> parseFeed(List<SyndEntry> entries) {\r\n    List<SiteArticle> articles = new ArrayList<SiteArticle>();\r\n    for (SyndEntry entry : entries) {\r\n        articles.add(new SiteArticle(\r\n          entry.getTitle(), entry.getLink(), entry.getPublishedDate()));\r\n    }\r\n    return articles;\r\n} \r\n```","```\r\npublic class SiteArticle {\r\n    private String title;\r\n    private String link;\r\n    private Date publishDate;\r\n}\r\n```","```\r\n@ExceptionHandler({ FeedServerException.class })\r\npublic ResponseEntity<Object> handleFeed(RuntimeException ex, WebRequest request) {\r\n    logger.error(\"500 Status Code\", ex);\r\n    String bodyOfResponse = ex.getLocalizedMessage();\r\n    return new ResponseEntity<Object>(bodyOfResponse, new HttpHeaders(), \r\n      HttpStatus.INTERNAL_SERVER_ERROR);\r\n}\r\n```","```\r\n@RequestMapping(value = \"/sites\")\r\n@ResponseBody\r\npublic List<Site> getSitesList() {\r\n    return service.getSitesByUser(getCurrentUser());\r\n}\r\n```","```\r\n<table>\r\n<thead>\r\n<tr><th>Site Name</th><th>Feed URL</th><th>Actions</th></tr>\r\n</thead>\r\n</table>\r\n<script>\r\n$(function(){\r\n\t$.get(\"sites\", function(data){\r\n        $.each(data, function( index, site ) {\r\n            $('.table').append('<tr><td>'+site.name+'</td><td>'+site.url+\r\n              '</td><td><a href=\"#\" onclick=\"deleteSite('+site.id+') \">Delete</a> </td></tr>');\r\n        });\r\n    });\r\n});\r\n\r\nfunction deleteSite(id){\r\n    $.ajax({ url: 'sites/'+id, type: 'DELETE', success: function(result) {\r\n            window.location.href=\"mysites\"\r\n        }\r\n    });\r\n}\r\n</script>\r\n```","```\r\n@RequestMapping(value = \"/sites\", method = RequestMethod.POST)\r\n@ResponseStatus(HttpStatus.OK)\r\npublic void addSite(Site site) {\r\n    if (!service.isValidFeedUrl(site.getUrl())) {\r\n        throw new FeedServerException(\"Invalid Feed Url\");\r\n    }\r\n    site.setUser(getCurrentUser());\r\n    service.saveSite(site);\r\n}\r\n```","```\r\n<form>\r\n    <input name=\"name\" />\r\n    <input id=\"url\" name=\"url\" />\r\n    <button type=\"submit\" onclick=\"addSite()\">Add Site</button>\r\n</form>\r\n\r\n<script>\r\nfunction addSite(){\r\n    $.post(\"sites\",$('form').serialize(), function(data){\r\n        window.location.href=\"mysites\";\r\n    }).fail(function(error){\r\n        alert(error.responseText);\r\n    });\r\n}\r\n</script>\r\n```","```\r\npublic boolean isValidFeedUrl(String feedUrl) {\r\n    try {\r\n        return getFeedEntries(feedUrl).size() > 0;\r\n    } catch (Exception e) {\r\n        return false;\r\n    }\r\n}\r\n```","```\r\n@RequestMapping(value = \"/sites/{id}\", method = RequestMethod.DELETE)\r\n@ResponseStatus(HttpStatus.OK)\r\npublic void deleteSite(@PathVariable(\"id\") Long id) {\r\n    service.deleteSiteById(id);\r\n}\r\n```","```\r\npublic void deleteSiteById(Long siteId) {\r\n    repo.delete(siteId);\r\n}\r\n```","```\r\n<button data-target=\"#myModal\">Load from My Sites</button>\r\n<div id=\"myModal\">\r\n    <button id=\"dropdownMenu1\">Choose Site</button><ul id=\"siteList\"></ul>\r\n    <button id=\"dropdownMenu2\">Choose Article</button><ul id=\"articleList\"></ul>\r\n    <button onclick=\"load()\">Load</button>\r\n</div>\r\n```","```\r\n$('#myModal').on('shown.bs.modal', function () {\r\n    if($(\"#siteList\").children().length > 0)\r\n        return;\r\n    $.get(\"sites\", function(data){\r\n        $.each(data, function( index, site ) {\r\n            $(\"#siteList\").append('<li><a href=\"#\" onclick=\"loadArticles('+\r\n              site.id+',\\''+site.name+'\\')\">'+site.name+'</a></li>')\r\n\t});\r\n    });\r\n});\r\n```","```\r\nfunction loadArticles(siteID,siteName){\r\n    $(\"#dropdownMenu1\").html(siteName);\r\n    $.get(\"sites/articles?id=\"+siteID, function(data){\r\n        $(\"#articleList\").html('');\r\n        $(\"#dropdownMenu2\").html('Choose Article');\r\n    $.each(data, function( index, article ) {\r\n        $(\"#articleList\").append(\r\n              '<li><a href=\"#\" onclick=\"chooseArticle(\\''+article.title+\r\n              '\\',\\''+article.link+'\\')\"><b>'+article.title+'</b> <small>'+\r\n              new Date(article.publishDate).toUTCString()+'</small></li>')\r\n    });\r\n    }).fail(function(error){ \r\n        alert(error.responseText); \r\n    });\r\n}\r\n```","```\r\n@RequestMapping(value = \"/sites/articles\")\r\n@ResponseBody\r\npublic List<SiteArticle> getSiteArticles(@RequestParam(\"id\") Long siteId) {\r\n    return service.getArticlesFromSite(siteId);\r\n}\r\n```","```\r\nvar title = \"\";\r\nvar link = \"\";\r\nfunction chooseArticle(selectedTitle,selectedLink){\r\n    $(\"#dropdownMenu2\").html(selectedTitle);\r\n    title=selectedTitle;\r\n    link = selectedLink;\r\n}\r\nfunction load(){\r\n    $(\"input[name='title']\").val(title);\r\n    $(\"input[name='url']\").val(link);\r\n}\r\n```","```\r\npublic class SiteIntegrationTest {\r\n\r\n    private ISiteService service;\r\n\r\n    @Before\r\n    public void init() {\r\n        service = new SiteService();\r\n    }\r\n\r\n    @Test\r\n    public void whenUsingServiceToReadWordpressFeed_thenCorrect() {\r\n        Site site = new Site(\"/feed/\");\r\n        List<SiteArticle> articles = service.getArticlesFromSite(site);\r\n\r\n        assertNotNull(articles);\r\n        for (SiteArticle article : articles) {\r\n            assertNotNull(article.getTitle());\r\n            assertNotNull(article.getLink());\r\n        }\r\n    }\r\n\r\n    @Test\r\n    public void whenUsingRomeToReadBloggerFeed_thenCorrect() {\r\n        Site site = new Site(\"http://blogname.blogspot.com/feeds/posts/default\");\r\n        List<SiteArticle> articles = service.getArticlesFromSite(site);\r\n\r\n        assertNotNull(articles);\r\n        for (SiteArticle article : articles) {\r\n            assertNotNull(article.getTitle());\r\n            assertNotNull(article.getLink());\r\n        }\r\n    }\r\n}\r\n```"]