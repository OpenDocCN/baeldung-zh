["```\r\nSubject subject = loginContext.getSubject();\r\nPrivilegedAction privilegedAction = new ResourceAction();\r\nSubject.doAsPrivileged(subject, privilegedAction, null); \r\n```","```\r\n@Override\r\npublic boolean commit() throws LoginException {\r\n    if (!loginSucceeded) {\r\n        return false;\r\n    }\r\n    userPrincipal = new UserPrincipal(username);\r\n    subject.getPrincipals().add(userPrincipal);\r\n    return true;\r\n}\r\n```"]