["```\r\n@Before\r\npublic void beforeEach() {\r\n    session = HibernateUtil.getSessionFactory().openSession();\r\n    session.beginTransaction();\r\n\r\n    this.detachedPost = new Post(\"Hibernate Tutorial\");\r\n    session.persist(detachedPost);\r\n    session.evict(detachedPost);\r\n}\r\n```","```\r\n@Test\r\npublic void givenDetachedPost_whenTryingToPersist_thenThrowException() {\r\n    detachedPost.setTitle(\"Hibernate Tutorial for Absolute Beginners\");\r\n\r\n    assertThatThrownBy(() -> session.persist(detachedPost))\r\n      .isInstanceOf(PersistenceException.class)\r\n      .hasMessageContaining(\"org.hibernate.PersistentObjectException: detached entity passed to persist\");\r\n}\r\n```","```\r\n@Test\r\npublic void givenDetachedPost_whenTryingToMerge_thenNoExceptionIsThrown() {\r\n    detachedPost.setTitle(\"Hibernate Tutorial for Beginners\");\r\n\r\n    session.merge(detachedPost);\r\n    session.getTransaction().commit();\r\n\r\n    List<Post> posts = session.createQuery(\"Select p from Post p\", Post.class).list();\r\n    assertThat(posts).hasSize(1);\r\n    assertThat(posts.get(0).getTitle())\r\n        .isEqualTo(\"Hibernate Tutorial for Beginners\");\r\n}\r\n```","```\r\n@Entity\r\npublic class Comment {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    private Long id;\r\n\r\n    private String text;\r\n\r\n    @ManyToOne(cascade = CascadeType.MERGE)\r\n    private Post post;\r\n\r\n    // constructor, getters and setters\r\n}\r\n```","```\r\n@Test\r\npublic void givenDetachedPost_whenMergeAndPersistComment_thenNoExceptionIsThrown() {\r\n    Comment comment = new Comment(\"nice article!\");\r\n    Post mergedPost = (Post) session.merge(detachedPost);\r\n    comment.setPost(mergedPost);\r\n\r\n    session.persist(comment);\r\n    session.getTransaction().commit();\r\n\r\n    List<Comment> comments = session.createQuery(\"Select c from Comment c\", Comment.class).list();\r\n    Comment savedComment = comments.get(0);\r\n    assertThat(savedComment.getText()).isEqualTo(\"nice article!\");\r\n    assertThat(savedComment.getPost().getTitle())\r\n        .isEqualTo(\"Hibernate Tutorial\");\r\n}\r\n```"]