# 根据 XSD 文件验证 XML 文件

> 原文：<https://web.archive.org/web/20220930061024/https://www.baeldung.com/java-validate-xml-xsd>

## 1.概观

在本教程中，我们将演示如何根据 XSD 文件验证一个 [XML](/web/20220830095532/https://www.baeldung.com/java-xml) 文件。

## 2.一个 XML 和两个 XSD 文件的定义

让我们考虑下面的 XML 文件`baeldung.xml`，它包含一个名称和一个地址，地址本身由邮政编码和城市组成:

[PRE0]

`baeldung.xml`的内容与`person.xsd` 文件的描述完全匹配:

[PRE1]

然而，我们的 XML 对于下面的 XSD 文件`full-person.xsd`是无效的:

[PRE2]

有两个问题:

*   名称属性最多限于 5 个字符
*   该地址需要街道属性

让我们看看如何使用 Java 来获取这些信息。

## 3.根据 XSD 文件验证 XML 文件

**`javax.xml.validation`包定义了一个验证 XML 文档的 API。
**

首先，我们将准备一个能够读取遵循 XML Schema 1.0 规范的文件的`SchemaFactory` 。然后，我们将使用这个`SchemaFactory`来创建对应于我们的 XSD 文件的`Schema`。一个`Schema`代表一组约束。

最后，我们将从`Schema`中检索`Validator`。`Validator`是根据`Schema`检查 XML 文档的处理器:

[PRE3]

在这段代码中，`getFile`方法允许我们[将 XSD](/web/20220830095532/https://www.baeldung.com/reading-file-in-java) 读成一个 [`File`](/web/20220830095532/https://www.baeldung.com/java-io-file) 。在我们的示例中，我们将文件放在 resources 目录下，因此该方法读作:

[PRE4]

让我们注意，当我们创建`Schema`时，如果 XSD 文件无效，就会抛出一个`SAXException`。

**我们现在可以使用`Validator`来验证 XML 文件是否匹配 XSD 描述。**`validate`方法要求我们将`File`转化为`StreamSource`:

[PRE5]

如果解析过程中出现错误,`validate`方法抛出一个`SAXException `。这表明根据 XSD 规范，XML 文件是无效的。

如果在读取文件时存在潜在问题，`validate`方法也可以抛出一个`[IOException](https://web.archive.org/web/20220830095532/https://baeldung-cn.com/java-checked-unchecked-exceptions)` 。

我们现在可以将代码包装在一个`XmlValidator`类中，并检查`baeldung.xml` 是否匹配`person.xsd`描述，而不是`full-person.xsd`:

[PRE6]

## 4.列出所有验证错误

`validate`方法的基本行为是一旦解析抛出一个`SAXException`就退出。

既然我们想要收集所有的验证错误，我们需要改变这种行为。为此，**我们要定义自己的`ErrorHandler` :**

[PRE7]

我们现在可以告诉`Validator`使用这个特定的`ErrorHandler`:

[PRE8]

由于`baeldung.xml`满足`person.xsd`的要求，在这种情况下没有列出错误。但是，用`full-person.xsd`调用，我们会打印以下错误信息:

[PRE9]

我们在第一节提到的所有错误。被程序发现了。

## 5.结论

在本文中，我们看到了如何根据 XSD 文件验证 XML 文件，并且我们还可以列出所有的验证错误。

和往常一样，代码可以在 GitHub 的[上获得。](https://web.archive.org/web/20220830095532/https://github.com/eugenp/tutorials/tree/master/xml-2)