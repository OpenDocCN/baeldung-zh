# 用 Spring MockMvc 测试异常

> 原文：<https://web.archive.org/web/20220930061024/https://www.baeldung.com/spring-mvc-test-exceptions>

## **1。概述**

在这篇短文中，我们将了解如何在控制器中抛出异常，以及如何使用 Spring MockMvc 测试这些异常。

## **2。控制器中抛出异常**

让我们开始学习**如何从控制器**发起异常。

我们可以把从控制器公开的服务想象成普通的 Java 函数:

[PRE0]

现在，让我们看看当我们调用这个服务时会发生什么。首先，我们会注意到服务的响应代码是 500，这意味着内部服务器错误。

其次，我们会收到这样的响应正文:

[PRE1]

总之，当我们从一个`RestController`抛出一个异常时，服务响应被自动映射到一个 500 响应代码，并且异常的堆栈跟踪被包含在响应体中。

## **3。将异常映射到 HTTP 响应代码**

现在我们将学习**如何将我们的异常映射到不同的响应代码**而不是 500。

为了实现这一点，我们将创建自定义异常并使用 Spring 提供的`ResponseStatus`注释。让我们创建这些自定义异常:

[PRE2]

[PRE3]

[PRE4]

第二步也是最后一步是在控制器中创建一个简单的服务来抛出这些异常:

[PRE5]

现在，让我们看看服务对我们映射的不同异常的不同响应:

*   对于`not_found`，我们收到响应代码 404
*   给定值`bad_arguments`，我们收到响应代码 400
*   对于任何其他值，我们仍然接收 500 作为响应代码

除了响应代码之外，我们还将收到一个与上一节中收到的响应正文格式相同的正文。

## **4。测试我们的控制器**

最后，我们将看到**如何测试我们的控制器正在抛出正确的异常**。

第一步是创建一个测试类，并创建一个`MockMvc`的实例:

[PRE6]

接下来，让我们为我们的服务可以接收的每个值创建测试用例:

[PRE7]

通过这些测试，我们检查响应代码、引发的异常类型和异常消息是否是每个值的预期值。

## **5。结论**

在本教程中，我们学习了如何处理 Spring `RestController`中的异常，以及如何测试每个公开的服务是否抛出了预期的异常。

和往常一样，本文的完整源代码可以在 [GitHub](https://web.archive.org/web/20221208143917/https://github.com/eugenp/tutorials/tree/master/spring-web-modules/spring-rest-testing) 中找到。