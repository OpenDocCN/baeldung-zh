["```\r\npublic void startThreads(ThreadPoolTaskExecutor taskExecutor, CountDownLatch countDownLatch, \r\n  int numThreads) {\r\n    for (int i = 0; i < numThreads; i++) {\r\n        taskExecutor.execute(() -> {\r\n            try {\r\n                Thread.sleep(100L * ThreadLocalRandom.current().nextLong(1, 10));\r\n                countDownLatch.countDown();\r\n            } catch (InterruptedException e) {\r\n                Thread.currentThread().interrupt();\r\n            }\r\n        });\r\n    }\r\n}\r\n```","```\r\n@Test\r\npublic void whenUsingDefaults_thenSingleThread() {\r\n    ThreadPoolTaskExecutor taskExecutor = new ThreadPoolTaskExecutor();\r\n    taskExecutor.afterPropertiesSet();\r\n\r\n    CountDownLatch countDownLatch = new CountDownLatch(10);\r\n    this.startThreads(taskExecutor, countDownLatch, 10);\r\n\r\n    while (countDownLatch.getCount() > 0) {\r\n        Assert.assertEquals(1, taskExecutor.getPoolSize());\r\n    }\r\n}\r\n```","```\r\n@Test\r\npublic void whenCorePoolSizeFive_thenFiveThreads() {\r\n    ThreadPoolTaskExecutor taskExecutor = new ThreadPoolTaskExecutor();\r\n    taskExecutor.setCorePoolSize(5);\r\n    taskExecutor.afterPropertiesSet();\r\n\r\n    CountDownLatch countDownLatch = new CountDownLatch(10);\r\n    this.startThreads(taskExecutor, countDownLatch, 10);\r\n\r\n    while (countDownLatch.getCount() > 0) {\r\n        Assert.assertEquals(5, taskExecutor.getPoolSize());\r\n    }\r\n}\r\n```","```\r\n@Test\r\npublic void whenCorePoolSizeFiveAndMaxPoolSizeTen_thenFiveThreads() {\r\n    ThreadPoolTaskExecutor taskExecutor = new ThreadPoolTaskExecutor();\r\n    taskExecutor.setCorePoolSize(5);\r\n    taskExecutor.setMaxPoolSize(10);\r\n    taskExecutor.afterPropertiesSet();\r\n\r\n    CountDownLatch countDownLatch = new CountDownLatch(10);\r\n    this.startThreads(taskExecutor, countDownLatch, 10);\r\n\r\n    while (countDownLatch.getCount() > 0) {\r\n        Assert.assertEquals(5, taskExecutor.getPoolSize());\r\n    }\r\n}\r\n```","```\r\n@Test\r\npublic void whenCorePoolSizeFiveAndMaxPoolSizeTenAndQueueCapacityTen_thenTenThreads() {\r\n    ThreadPoolTaskExecutor taskExecutor = new ThreadPoolTaskExecutor();\r\n    taskExecutor.setCorePoolSize(5);\r\n    taskExecutor.setMaxPoolSize(10);\r\n    taskExecutor.setQueueCapacity(10);\r\n    taskExecutor.afterPropertiesSet();\r\n\r\n    CountDownLatch countDownLatch = new CountDownLatch(20);\r\n    this.startThreads(taskExecutor, countDownLatch, 20);\r\n\r\n    while (countDownLatch.getCount() > 0) {\r\n        Assert.assertEquals(10, taskExecutor.getPoolSize());\r\n    }\r\n}\r\n```"]