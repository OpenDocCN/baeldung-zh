# REST 查询语言-高级搜索操作

> 原文：<https://web.archive.org/web/20220930061024/https://www.baeldung.com/rest-api-query-search-language-more-operations>

[This article is part of a series:](javascript:void(0);)[• REST Query Language with Spring and JPA Criteria](/web/20220529015703/https://www.baeldung.com/rest-search-language-spring-jpa-criteria)
[• REST Query Language with Spring Data JPA Specifications](/web/20220529015703/https://www.baeldung.com/rest-api-search-language-spring-data-specifications)
[• REST Query Language with Spring Data JPA and Querydsl](/web/20220529015703/https://www.baeldung.com/rest-api-search-language-spring-data-querydsl)
• REST Query Language – Advanced Search Operations (current article)[• REST Query Language – Implementing OR Operation](/web/20220529015703/https://www.baeldung.com/rest-api-query-search-or-operation)
[• REST Query Language with RSQL](/web/20220529015703/https://www.baeldung.com/rest-api-search-language-rsql-fiql)
[• REST Query Language with Querydsl Web Support](/web/20220529015703/https://www.baeldung.com/rest-api-search-querydsl-web-in-spring-data-jpa)

## **1。概述**

在本文中，我们将扩展我们在[中开发的 REST 查询语言，将](/web/20220529015703/https://www.baeldung.com/rest-api-search-language-spring-data-specifications "REST Query Language with Spring Data JPA Specifications")[系列](/web/20220529015703/https://www.baeldung.com/spring-rest-api-query-search-language-tutorial)的前几部分扩展到**，包括更多的搜索操作**。

我们现在支持以下操作:等于、否定、大于、小于、开始于、结束于、包含和喜欢。

注意，我们探讨了三个实现——JPA 标准、Spring 数据 JPA 规范和查询 DSL 在本文中，我们将继续使用规范，因为这是一种简洁而灵活的方式来表示我们的操作。

## **2。`SearchOperation` `enum`**

首先，让我们通过枚举来更好地表示我们支持的各种搜索操作:

[PRE0]

我们有两组操作:

1.**简单**——可以用一个字符表示:

*   相等:用冒号(`:`)表示
*   否定:用感叹号(`!`)表示
*   大于:由(`>`)表示
*   小于:由(`<`)表示
*   喜欢:用波浪号(`~`)表示

2.**复杂**–需要多个字符来表示:

*   开始于:由(`=prefix*`)表示
*   结尾为:由(`=*suffix`)表示
*   包含:由(`=*substring*`)表示

我们还需要修改我们的`SearchCriteria`类来使用新的`SearchOperation`:

[PRE1]

## **3。修改`UserSpecification`**

现在，让我们将新支持的操作包括到我们的`UserSpecification`实现中:

[PRE2]

## **4。持久性测试**

接下来，让我们在持久性级别测试我们的新搜索操作:

### **4.1。测试等式**

在下面的例子中，我们将通过名字和姓氏来搜索用户**:**

[PRE3]

### **4.2。测试否定**

接下来，让我们搜索名字不是“John”的用户:

[PRE4]

### **4.3。测试大于**

接下来，我们将搜索**年龄大于“25”**的用户:

[PRE5]

### 4.4。测试从开始

下一个–名字以“jo”开头的用户:

[PRE6]

### **4.5。测试以**结束

接下来，我们将搜索名字以“n”结尾的用户:

[PRE7]

### 4.6。测试包含

现在，我们将搜索名字中包含“oh”的用户:

[PRE8]

### **4.7。测试范围**

最后，我们将搜索年龄在“20”和“25”之间的用户:

[PRE9]

## **5。`UserSpecificationBuilder`**

既然持久性已经完成并经过测试，让我们将注意力转移到 web 层。

我们将在上一篇文章的`UserSpecificationBuilder`实现的基础上构建**并加入新的搜索操作**:

[PRE10]

## **6。`UserController`**

接下来——我们需要修改我们的`UserController`,以便正确地**解析新的操作**:

[PRE11]

现在，我们可以点击 API，使用任何标准组合获得正确的结果。例如，下面是使用 API 和查询语言的复杂操作:

[PRE12]

回应是:

[PRE13]

## **7**T2。搜索 API 的测试

最后，让我们通过编写一套 API 测试来确保我们的 API 运行良好。

我们将从测试的简单配置和数据初始化开始:

[PRE14]

### 7.1。测试等式

首先，让我们搜索一个名字为**`john`，姓氏为`doe`**的用户:

[PRE15]

### 7.2。测试否定

现在，我们将搜索名字不是“john”的用户**:**

[PRE16]

### 7.3。测试大于

接下来，我们将寻找**年龄大于“25”**的用户:

[PRE17]

### 7.4。测试从开始

下一个–名字以“jo”开头的用户:

[PRE18]

### **7.5。测试以**结束

现在–名字以“n”结尾的用户**:**

[PRE19]

### 7.6。测试包含

接下来，我们将搜索名字中包含“oh”的用户:

[PRE20]

### 7.7。测试范围

最后，我们将搜索年龄在“20”和“25”之间的用户:

[PRE21]

## **8。结论**

在本文中，我们将 REST 搜索 API 的查询语言带到了成熟的、经过测试的产品级实现。我们现在支持各种各样的操作和约束，这使得优雅地跨越任何数据集并获得我们正在寻找的确切资源变得非常容易。

本文的**完整实现**可以在[的 GitHub 项目](https://web.archive.org/web/20220529015703/https://github.com/eugenp/tutorials/tree/master/spring-web-modules/spring-rest-query-language "The Full Example Project on Github")中找到——这是一个基于 Maven 的项目，因此应该很容易导入和运行。

Next **»**[REST Query Language – Implementing OR Operation](/web/20220529015703/https://www.baeldung.com/rest-api-query-search-or-operation)**«** Previous[REST Query Language with Spring Data JPA and Querydsl](/web/20220529015703/https://www.baeldung.com/rest-api-search-language-spring-data-querydsl)****