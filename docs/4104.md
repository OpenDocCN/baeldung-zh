# Reddit 应用程序的第四轮改进

> 原文：<https://web.archive.org/web/20220930061024/https://www.baeldung.com/reddit-web-app-improvements-4>

## **1。概述**

在本教程中，我们将继续改进我们正在构建的简单 Reddit 应用程序，它是[公共案例研究](/web/20220813071757/https://www.baeldung.com/case-study-a-reddit-app-with-spring)的一部分。

## **2。为管理员提供更好的表格**

首先，我们将通过使用 jQuery DataTable 插件，使管理页面中的表与面向用户的应用程序中的表处于相同的级别。

### **2.1。让用户分页–服务层**

让我们在服务层中添加启用分页的操作:

[PRE0]

### **2.2。用户 DTO**

下一步——现在让我们确保一致地将 dto 干净地返回给客户端。

我们将需要一个用户 DTO，因为到目前为止，API 将实际的`User`实体返回给客户端:

[PRE1]

### **2.3。让用户分页——在控制器中**

现在，让我们也在控制器层实现这个简单的操作:

[PRE2]

这是 DTO 转换逻辑:

[PRE3]

### **2.4。前端**

最后，在客户端，让我们使用这个新操作并重新实现我们的管理员用户页面:

[PRE4]

## **3。禁用用户**

接下来，我们将构建一个简单的管理特性—**禁用用户**的能力。

我们首先需要的是`User`实体中的`enabled`字段:

[PRE5]

然后，我们可以在我们的`UserPrincipal`实现中使用它来确定主体是否被启用:

[PRE6]

这里是处理禁用/启用用户的 API 操作:

[PRE7]

下面是简单的服务层实现:

[PRE8]

## **4。处理会话超时**

接下来，让我们配置应用程序**来处理会话超时**——我们将向我们的上下文[添加一个简单的`SessionListener`来控制会话超时](/web/20220813071757/https://www.baeldung.com/servlet-session-timeout):

[PRE9]

下面是 Spring 安全配置:

[PRE10]

注意:

*   我们将会话超时设置为 5 分钟。
*   当会话到期时，用户将被重定向到登录页面。

## **5。增强注册**

接下来，我们将通过添加一些以前缺少的功能来增强注册流程。

我们在这里只说明要点；要深入注册，请查看 **[注册系列](/web/20220813071757/https://www.baeldung.com/spring-security-registration)** 。

### **5.1。注册确认电子邮件**

注册时缺少的一个功能是用户不会被提示确认他们的电子邮件。

我们现在让用户在系统中激活之前先确认他们的电子邮件地址:

[PRE11]

服务层也需要做一些工作，基本上是确保用户最初是禁用的:

[PRE12]

现在确认一下:

[PRE13]

[PRE14]

### 5.2。触发密码重置

现在，让我们看看如何允许用户在忘记密码的情况下重置自己的密码:

[PRE15]

现在，服务层只需向用户发送一封电子邮件，其中包含用户可以重置密码的链接:

[PRE16]

### 5.3。重置密码

一旦用户点击邮件中的链接，他们实际上可以**执行重置密码操作**:

[PRE17]

服务层:

[PRE18]

最后，下面是更新密码的实现:

[PRE19]

### 5.4。更改密码

接下来，我们将实现类似的功能—在内部更改您的密码:

[PRE20]

[PRE21]

## **6。启动项目**

接下来，让我们将项目转换/升级到 Spring Boot；首先，我们将修改`pom.xml`:

[PRE22]

并且还为**提供了一个简单的启动应用程序用于启动**:

[PRE23]

注意**新的基础 URL** 现在将是`http://localhost:8080`而不是旧的`http://localhost:8080/reddit-scheduler`。

## 7 .**。外部化属性**

现在我们已经启动了，我们可以使用`@ConfigurationProperties`来具体化我们的 Reddit 属性:

[PRE24]

我们现在可以以类型安全的方式干净地使用这些属性:

[PRE25]

## **8。结论**

这一轮的改进对于应用程序来说是一个很好的进步。

我们不再添加任何主要特性，这使得架构改进成为下一个合乎逻辑的步骤——这就是本文所要讨论的。