["```\r\n<dependency>\r\n    <groupId>javax</groupId>\r\n    <artifactId>javaee-api</artifactId>\r\n    <version>8.0</version>\r\n    <scope>provided</scope>\r\n</dependency>\r\n\r\n<dependency>\r\n    <groupId>org.apache.openejb</groupId>\r\n    <artifactId>tomee-embedded</artifactId>\r\n    <version>1.7.5</version>\r\n</dependency>\r\n```","```\r\n@Local\r\npublic interface CountryState {\r\n   List<String> getStates(String country);\r\n   void setStates(String country, List<String> states);\r\n}\r\n```","```\r\n@Singleton\r\n@Startup\r\npublic class CountryStateContainerManagedBean implements CountryState {\r\n    ...\r\n}\r\n```","```\r\n@Singleton \r\n@Startup \r\n@DependsOn({\"DependentBean1\", \"DependentBean2\"}) \r\npublic class CountryStateCacheBean implements CountryState { \r\n    ...\r\n}\r\n```","```\r\n@PostConstruct\r\npublic void initialize() {\r\n\r\n    List<String> states = new ArrayList<String>();\r\n    states.add(\"Texas\");\r\n    states.add(\"Alabama\");\r\n    states.add(\"Alaska\");\r\n    states.add(\"Arizona\");\r\n    states.add(\"Arkansas\");\r\n\r\n    countryStatesMap.put(\"UnitedStates\", states);\r\n}\r\n```","```\r\n@Singleton\r\n@Startup\r\n@ConcurrencyManagement(ConcurrencyManagementType.CONTAINER)\r\npublic class CountryStateContainerManagedBean implements CountryState {\r\n    ...\r\n}\r\n```","```\r\n@Singleton \r\n@Startup \r\n@ConcurrencyManagement(ConcurrencyManagementType.CONTAINER) \r\npublic class CountryStateContainerManagedBean implements CountryState { \r\n\r\n    private final Map<String, List<String> countryStatesMap = new HashMap<>();\r\n\r\n    @Lock(LockType.READ) \r\n    public List<String> getStates(String country) { \r\n        return countryStatesMap.get(country);\r\n    }\r\n\r\n    @Lock(LockType.WRITE)\r\n    public void setStates(String country, List<String> states) {\r\n        countryStatesMap.put(country, states);\r\n    }\r\n}\r\n```","```\r\n@Singleton \r\n@Startup \r\n@ConcurrencyManagement(ConcurrencyManagementType.BEAN) \r\npublic class CountryStateBeanManagedBean implements CountryState { \r\n   ... \r\n}\r\n```","```\r\npublic synchronized void setStates(String country, List<String> states) {\r\n    countryStatesMap.put(country, states);\r\n}\r\n```","```\r\npublic class CountryStateCacheBeanTest {\r\n\r\n    private EJBContainer ejbContainer = null;\r\n\r\n    private Context context = null;\r\n\r\n    @Before\r\n    public void init() {\r\n        ejbContainer = EJBContainer.createEJBContainer();\r\n        context = ejbContainer.getContext();\r\n    }\r\n}\r\n```","```\r\n@Test\r\npublic void whenCallGetStatesFromContainerManagedBean_ReturnsStatesForCountry() throws Exception {\r\n\r\n    String[] expectedStates = {\"Texas\", \"Alabama\", \"Alaska\", \"Arizona\", \"Arkansas\"};\r\n\r\n    CountryState countryStateBean = (CountryState) context\r\n      .lookup(\"java:global/singleton-ejb-bean/CountryStateContainerManagedBean\");\r\n    List<String> actualStates = countryStateBean.getStates(\"UnitedStates\");\r\n\r\n    assertNotNull(actualStates);\r\n    assertArrayEquals(expectedStates, actualStates.toArray());\r\n}\r\n\r\n@Test\r\npublic void whenCallSetStatesFromContainerManagedBean_SetsStatesForCountry() throws Exception {\r\n\r\n    String[] expectedStates = { \"California\", \"Florida\", \"Hawaii\", \"Pennsylvania\", \"Michigan\" };\r\n\r\n    CountryState countryStateBean = (CountryState) context\r\n      .lookup(\"java:global/singleton-ejb-bean/CountryStateContainerManagedBean\");\r\n    countryStateBean.setStates(\r\n      \"UnitedStates\", Arrays.asList(expectedStates));\r\n\r\n    List<String> actualStates = countryStateBean.getStates(\"UnitedStates\");\r\n    assertNotNull(actualStates);\r\n    assertArrayEquals(expectedStates, actualStates.toArray());\r\n}\r\n```","```\r\n@Test\r\npublic void whenCallGetStatesFromBeanManagedBean_ReturnsStatesForCountry() throws Exception {\r\n\r\n    String[] expectedStates = { \"Texas\", \"Alabama\", \"Alaska\", \"Arizona\", \"Arkansas\" };\r\n\r\n    CountryState countryStateBean = (CountryState) context\r\n      .lookup(\"java:global/singleton-ejb-bean/CountryStateBeanManagedBean\");\r\n    List<String> actualStates = countryStateBean.getStates(\"UnitedStates\");\r\n\r\n    assertNotNull(actualStates);\r\n    assertArrayEquals(expectedStates, actualStates.toArray());\r\n}\r\n\r\n@Test\r\npublic void whenCallSetStatesFromBeanManagedBean_SetsStatesForCountry() throws Exception {\r\n\r\n    String[] expectedStates = { \"California\", \"Florida\", \"Hawaii\", \"Pennsylvania\", \"Michigan\" };\r\n\r\n    CountryState countryStateBean = (CountryState) context\r\n      .lookup(\"java:global/singleton-ejb-bean/CountryStateBeanManagedBean\");\r\n    countryStateBean.setStates(\"UnitedStates\", Arrays.asList(expectedStates));\r\n\r\n    List<String> actualStates = countryStateBean.getStates(\"UnitedStates\");\r\n    assertNotNull(actualStates);\r\n    assertArrayEquals(expectedStates, actualStates.toArray());\r\n}\r\n```","```\r\n@After\r\npublic void close() {\r\n    if (ejbContainer != null) {\r\n        ejbContainer.close();\r\n    }\r\n}\r\n```"]