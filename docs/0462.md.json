["```\r\nGSSManager manager = GSSManager.getInstance();\r\nString serverPrinciple = \"HTTP/[[emailÂ protected]](/web/20221025183651/https://www.baeldung.com/cdn-cgi/l/email-protection)\";\r\nGSSName serverName = manager.createName(serverPrinciple, null);\r\nOid krb5Oid = new Oid(\"1.2.840.113554.1.2.2\");\r\nGSSContext clientContext = manager.createContext(\r\n  serverName, krb5Oid, (GSSCredential)null, GSSContext.DEFAULT_LIFETIME);\r\nclientContext.requestMutualAuth(true);\r\nclientContext.requestConf(true);\r\nclientContext.requestInteg(true);\r\n```","```\r\nGSSManager manager = GSSManager.getInstance();\r\nGSSContext serverContext = manager.createContext((GSSCredential) null);\r\n```","```\r\n// On the client-side\r\nclientToken = clientContext.initSecContext(new byte[0], 0, 0);\r\nsendToServer(clientToken); // This is supposed to be send over the network\r\n\r\n// On the server-side\r\nserverToken = serverContext.acceptSecContext(clientToken, 0, clientToken.length);\r\nsendToClient(serverToken); // This is supposed to be send over the network\r\n\r\n// Back on the client side\r\nclientContext.initSecContext(serverToken, 0, serverToken.length);\r\n```","```\r\nassertTrue(serverContext.isEstablished());\r\nassertTrue(clientContext.isEstablished());\r\n```","```\r\n// On the client-side\r\nbyte[] messageBytes = \"Baeldung\".getBytes();\r\nMessageProp clientProp = new MessageProp(0, true);\r\nbyte[] clientToken = clientContext.wrap(messageBytes, 0, messageBytes.length, clientProp);\r\nsendToClient(serverToken); // This is supposed to be send over the network\r\n\r\n// On the server-side \r\nMessageProp serverProp = new MessageProp(0, false);\r\nbyte[] bytes = serverContext.unwrap(clientToken, 0, clientToken.length, serverProp);\r\nString string = new String(bytes);\r\nassertEquals(\"Baeldung\", string);\r\n```","```\r\n-Djavax.security.auth.useSubjectCredsOnly=false\r\n```","```\r\ncom.sun.security.jgss.initiate  {\r\n  com.sun.security.auth.module.Krb5LoginModule required\r\n  useKeyTab=true\r\n  keyTab=example.keytab\r\n  principal=\"client/localhost\"\r\n  storeKey=true;\r\n};\r\ncom.sun.security.jgss.accept  {\r\n  com.sun.security.auth.module.Krb5LoginModule required\r\n  useKeyTab=true\r\n  keyTab=example.keytab\r\n  storeKey=true\r\n  principal=\"HTTP/localhost\";\r\n};\r\n```","```\r\n-Djava.security.auth.login.config=login.conf\r\n```","```\r\n[libdefaults]\r\ndefault_realm = EXAMPLE.COM\r\nudp_preference_limit = 1\r\n[realms]\r\nEXAMPLE.COM = {\r\n    kdc = localhost:52135\r\n}\r\n```","```\r\n-Djava.security.krb5.conf=krb5.conf\r\n```","```\r\njava -Djava.security.krb5.conf=krb5.conf \\\r\n  -Djavax.security.auth.useSubjectCredsOnly=false \\\r\n  -Djava.security.auth.login.config=login.conf \\\r\n  com.baeldung.jgss.JgssUnitTest\r\n```"]