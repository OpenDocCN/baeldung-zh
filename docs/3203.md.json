["```\r\n$ cat docker-compose.yml\r\n---\r\nversion: '2'\r\nservices:\r\n  zookeeper-1:\r\n    image: confluentinc/cp-zookeeper:latest\r\n    environment:\r\n      ZOOKEEPER_CLIENT_PORT: 2181\r\n      ZOOKEEPER_TICK_TIME: 2000\r\n    ports:\r\n      - 2181:2181\r\n\r\n  kafka-1:\r\n    image: confluentinc/cp-kafka:latest\r\n    depends_on:\r\n      - zookeeper-1\r\n    ports:\r\n      - 29092:29092\r\n    environment:\r\n      KAFKA_BROKER_ID: 1\r\n      KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181\r\n      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka-1:9092,PLAINTEXT_HOST://localhost:29092\r\n      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT\r\n      KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT\r\n      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1\r\n  kafka-2:\r\n    image: confluentinc/cp-kafka:latest\r\n    depends_on:\r\n      - zookeeper-1\r\n    ports:\r\n      - 39092:39092\r\n    environment:\r\n      KAFKA_BROKER_ID: 2\r\n      KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181\r\n      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka-2:9092,PLAINTEXT_HOST://localhost:39092\r\n      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT\r\n      KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT\r\n      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1 \r\n```","```\r\n$ docker-compose up -d\r\n```","```\r\n$ ports=(2181 29092 39092)\r\n$ for port in $ports\r\ndo\r\nnc -z localhost $port\r\ndone\r\nConnection to localhost port 2181 [tcp/eforward] succeeded!\r\nConnection to localhost port 29092 [tcp/*] succeeded!\r\nConnection to localhost port 39092 [tcp/*] succeeded!\r\n```","```\r\n$ /usr/local/bin/zookeeper-shell localhost:2181\r\nConnecting to localhost:2181\r\nWelcome to ZooKeeper! \r\n```","```\r\nls /brokers/ids\r\n[1, 2]\r\n```","```\r\nget /brokers/ids/1\r\n{\"features\":{},\"listener_security_protocol_map\":{\"PLAINTEXT\":\"PLAINTEXT\",\"PLAINTEXT_HOST\":\"PLAINTEXT\"},\"endpoints\":[\"PLAINTEXT://kafka-1:9092\",\"PLAINTEXT_HOST://localhost:29092\"],\"jmx_port\":-1,\"port\":9092,\"host\":\"kafka-1\",\"version\":5,\"timestamp\":\"1625336133848\"}\r\nget /brokers/ids/2\r\n{\"features\":{},\"listener_security_protocol_map\":{\"PLAINTEXT\":\"PLAINTEXT\",\"PLAINTEXT_HOST\":\"PLAINTEXT\"},\"endpoints\":[\"PLAINTEXT://kafka-2:9092\",\"PLAINTEXT_HOST://localhost:39092\"],\"jmx_port\":-1,\"port\":9092,\"host\":\"kafka-2\",\"version\":5,\"timestamp\":\"1625336133967\"}\r\n```","```\r\nquit\r\n```","```\r\n$ zkCli -server localhost:2181 get /brokers/ids/1\r\nConnecting to localhost:2181\r\n\r\nWATCHER::\r\n\r\nWatchedEvent state:SyncConnected type:None path:null\r\n{\"features\":{},\"listener_security_protocol_map\":{\"PLAINTEXT\":\"PLAINTEXT\",\"PLAINTEXT_HOST\":\"PLAINTEXT\"},\"endpoints\":[\"PLAINTEXT://kafka-1:9092\",\"PLAINTEXT_HOST://localhost:29092\"],\"jmx_port\":-1,\"port\":9092,\"host\":\"kafka-1\",\"version\":5,\"timestamp\":\"1625336133848\"}\r\n```","```\r\n$ kafka-broker-api-versions --bootstrap-server localhost:29092 | awk '/id/{print $1}'\r\nlocalhost:39092\r\nlocalhost:29092\r\n```","```\r\n$ cat functions.sh\r\n#!/bin/bash\r\nZOOKEEPER_SERVER=\"${1:-localhost:2181}\"\r\n\r\n# Helper Functions Below\r\n```","```\r\nfunction get_broker_ids {\r\nbroker_ids_out=$(zkCli -server $ZOOKEEPER_SERVER <<EOF\r\nls /brokers/ids\r\nquit\r\nEOF\r\n)\r\nbroker_ids_csv=\"$(echo \"${broker_ids_out}\" | grep '^\\[.*\\]$')\"\r\necho \"$broker_ids_csv\" | sed 's/\\[//;s/]//;s/,/ /'\r\n}\r\n```","```\r\nfunction get_broker_details {\r\nbroker_id=\"$1\"\r\necho \"$(zkCli -server $ZOOKEEPER_SERVER <<EOF\r\nget /brokers/ids/$broker_id\r\nquit\r\nEOF\r\n)\"\r\n}\r\n```","```\r\nfunction parse_endpoint_detail {\r\nbroker_detail=\"$1\"\r\njson=\"$(echo \"$broker_detail\"  | grep '^{.*}$')\"\r\njson_endpoints=\"$(echo $json | jq .endpoints)\"\r\necho \"$(echo $json_endpoints |jq . |  grep HOST | tr -d \" \")\"\r\n}\r\n```","```\r\n$ cat get_all_active_brokers.sh\r\n#!/bin/bash\r\n. functions.sh \"$1\"\r\n\r\nfunction get_all_active_brokers {\r\nbroker_ids=$(get_broker_ids)\r\nfor broker_id in $broker_ids\r\ndo\r\n    broker_details=\"$(get_broker_details $broker_id)\"\r\n    broker_endpoint=$(parse_endpoint_detail \"$broker_details\")\r\n    echo \"broker_id=\"$broker_id,\"endpoint=\"$broker_endpoint\r\ndone\r\n}\r\n\r\nget_all_active_brokers\r\n```","```\r\n$ ./get_all_active_brokers.sh localhost:2181\r\nbroker_id=1,endpoint=\"PLAINTEXT_HOST://localhost:29092\"\r\nbroker_id=2,endpoint=\"PLAINTEXT_HOST://localhost:39092\"\r\n```"]